n = 10
mus = seq(0, 3, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, -(c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 100
mus = seq(0, 3, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 10
mus = seq(0, 3, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 10
mus = seq(0, 20, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 10
mus = seq(0, 100, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 100
mus = seq(0, 100, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 100
mus = seq(0, 10, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 100
mus = seq(0, 6, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 100
mus = seq(0.95, 1.05, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 100
mus = seq(0.95, 1.2, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 10
mus = seq(0.95, 1.2, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 1000
mus = seq(0.95, 1.2, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 1000
mus = seq(0.95, 6, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 1000
mus = seq(0.95, 10, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 1
n = 1000
mus = seq(0.95, 1000, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 2
n = 10
mus = seq(1, 100, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 2
n = 10
mus = seq(1, 5, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 2
n = 10
mus = seq(1, 10, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 2
n = 100
mus = seq(1, 10, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 2
n = 1000
mus = seq(1, 10, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
x = 2
n = 1000
mus = seq(1, 100, by = 0.01)
c = qchisq(0.95, 1)
plot(mus, (c*mus^4 - mus^2*(c + n) + 2*n*x*mus - n*x^2), type = "l")
abline(h = 0)
plot(mus, dlnorm(mus, 0, 10), by = 0.01)
plot(mus, dlnorm(mus, 0, 10), type = "l")
plot(mus, dlnorm(mus, 0, 100), type = "l")
plot(mus, dlnorm(mus, -10, 100), type = "l")
plot(mus, dlnorm(mus, -100, 1000), type = "l")
plot(mus, dlnorm(mus, -1000, 10000), type = "l")
lines(mus 1/mus)
lines(mus, 1/mus)
plot(mus, 1/mus)
plot(mus, dlnorm(mus, -10000, 100000), type = "l")
plot(mus, dlnorm(mus, -100000, 1000000), type = "l")
plot(mus, dlnorm(mus, -100000, 1000000)/(4*10^-7), type = "l")
plot(mus, dlnorm(mus, -10000, 100000)/(4*10^-7), type = "l")
plot(mus, dlnorm(mus, -10000, 100000)/(4*10^-6), type = "l")
lines(mus, 1/mus, col = "blye")
lines(mus, 1/mus, col = "blue")
plot(mus, dlnorm(mus, -100000, 10000), type = "l")
lines(mus, 1/mus^2, col = "blue")
plot(mus, 1/mus^2, col = "blue")
?dlnorm
plot(mus, dlnorm(mus, -1, 1), type = "l")
plot(mus, dlnorm(mus, -100, 10), type = "l")
plot(mus, dlnorm(mus, -(100)^2, 100), type = "l")
100^2
plot(mus, dlnorm(mus, -(100)^2, 100), type = "l")
plot(mus, dlnorm(mus, -(10)^2, 10), type = "l")
plot(mus, dlnorm(mus, -(5)^2, 5), type = "l")
plot(mus, 1/mus^2, col = "blue")
mus = seq(0, 100, by = 0.001)
plot(mus, dlnorm(mus, -(5)^2, 5), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, -(5)^2, 5), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, -(50)^2, 50), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, -(10)^2, 10), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, -(1)^2, 1), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, -(5)^2, 5), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, -(10)^2, 10), type = "l")
mus = seq(1, 10, by = 0.001)
plot(mus, dlnorm(mus, -(10)^2, 10), type = "l")
plot(mus, 1/mus^2)
mus = seq(1, 10, by = 0.001)
plot(mus, dlnorm(mus, -(100)^2, 100), type = "l")
mus = seq(1, 10, by = 0.001)
plot(mus, dlnorm(mus, -(30)^2, 30), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, -(1)^2, 1), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, -(3)^2, 3), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, -3, 3), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, -10, 10), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 0, 10), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 0, 100), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 10, 100), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 100, 100), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 100, 10), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 5^2, 5), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 7^2, 7), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 0, 7), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 0, 7), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 0, 1), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 1, 1), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 1, 10), type = "l")
mus = seq(0, 10, by = 0.001)
plot(mus, dlnorm(mus, 4, 10), type = "l")
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
lm(y ~ x1 + x2 + x3)
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
f = function(N, R) (N-2)*R^2/(1 - R^2)
f(160, 0.13)
?pf
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
f = function(N, R) (N-2)*R^2/(1 - R^2)
pf(f, df1 = 3, df2 = N - 4)
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
N = 160
R = 0.13
f = function(N, R) (N-2)*R^2/(1 - R^2)
pf(f(N, R), df1 = 3, df2 = N - 4)
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
N = 160
R = 0.13
f = function(N, R) (N-2)*R^2/(1 - R^2)
1 - pf(f(N, R), df1 = 3, df2 = N - 4)
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
N = 160
R = 0.13
f = function(N, R) (N-2)*R^2/(1 - R^2)
1 - pf(f(N, R), df1 = 3, df2 = N - 4)
N = 170
P = 4
R = 0.13
f = function(N, R) (N-2)*R^2/(1 - R^2)
1 - pf(f(N, R), df1 = 3, df2 = N - (P + 1))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
N = 170
P = 4
R = 0.13
f = function(N, R) (N - (K + 1))/K*R^2/(1 - R^2)
1 - pf(f(N, R), df1 = 3, df2 = N - (P + 1))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
N = 170
P = 4
R = 0.13
f = function(N, R) (N - (P + 1))/P*R^2/(1 - R^2)
1 - pf(f(N, R), df1 = 3, df2 = N - (P + 1))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
N = 170
P = 4
R = 0.13
f = function(N, R) (N - (P + 1))/P*R^2/(1 - R^2)
1 - pf(f(N, R), df1 = P, df2 = N - (P + 1))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
N = 170
P = 3
R = 0.13
f = function(N, R) (N - (P + 1))/P*R^2/(1 - R^2)
1 - pf(f(N, R), df1 = P, df2 = N - (P + 1))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
N = 170
P = 4
R = 0.13
f = function(N, R) (N - (P + 1))/P*R^2/(1 - R^2)
1 - pf(f(N, R), df1 = P, df2 = N - (P + 1))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))
N = 170
P = 4
R = 0.13
f = function(N, R) (N - (P + 1))/(P - 1)*R^2/(1 - R^2)
1 - pf(f(N, R), df1 = P, df2 = N - (P + 1))
summary.lm
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))$fstatistic
anova(lm(y ~ x1 + x2 + x3))
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))$fstatistic
anova(lm(y ~ x1 + x2 + x3))
lm(y ~ x1 + x2 + x3)
summary(lm(y ~ x1 + x2 + x3))
N = 170
P = 4
R = 0.008458
f = function(N, R) (N - (P + 1))/(P - 1)*R^2/(1 - R^2)
1 - pf(f(N, R), df1 = P, df2 = N - (P + 1))
f(N, R), df1 = P, df2 = N - (P + 1)
f(N, R)
N = 170
P = 4
R = 0.008458
f = function(N, R) (N - (P + 1))*R^2/(1 - R^2)
f(N, R)
N = 160
P = 3
R = 0.008458
f = function(N, R) (N - (P + 1))*R^2/(1 - R^2)
1 - pf(f(N, R), df1 = P, df2 = N - (P + 1))
f(N, R)
summary(lm(y ~ x1 + x2 + x3))$fstatistic
lm(y ~ x1 + x2 + x3)
summary(lm(y ~ x1 + x2 + x3))
N = 160
P = 3
R = 0.008458
f = function(N, R) (N - (P + 1))/P*R^2/(1 - R^2)
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))$fstatistic
anova(lm(y ~ x1 + x2 + x3))
N = 160
P = 3
Rsq = 0.008458
f = function(N, Rsq) (N - (P + 1))/P*Rsq/(1 - Rsq)
1 - pf(f(N, R), df1 = P, df2 = N - (P + 1))
N = 170
P = 4
Rsq = 0.135
f = function(N, Rsq) (N - (P + 1))/P*Rsq/(1 - Rsq)
1 - pf(f(N, R), df1 = P, df2 = N - (P + 1))
N = 170
P = 4
Rsq = 0.135
f = function(N, Rsq) (N - (P + 1))/P*Rsq/(1 - Rsq)
1 - pf(f(N, Rsq), df1 = P, df2 = N - (P + 1))
get_p_val = function(N, P, Rsq) {
f = function(N, Rsq) (N - (P + 1))/P*Rsq/(1 - Rsq)
pf(f(N, Rsq), df1 = P, df2 = N - (P + 1), lower.tail = FALSE)
}
get_p_val(170, 4, 0.135)
get_p_val(170, 1, 0.135)
get_p_val(170, 5, 0.135)
get_p_val(170, 10, 0.135)
get_p_val(170, 20, 0.135)
get_p_val(170, 15, 0.135)
get_p_val(170, 12, 0.135)
get_p_val(170, 11, 0.135)
get_p_val(170, 12, 0.135)
get_p_val(170, 4, 0.135)
get_p_val = function(N, P, Rsq) {
f = (N - (P + 1))/P*Rsq/(1 - Rsq)
pf(f, df1 = P, df2 = N - (P + 1), lower.tail = FALSE)
}
get_p_val(N = 170, P = 4, Rsq = 0.135)
get_p_val(N = 170, P = 12, Rsq = 0.135)
N_max = 170
sapply(1:N_max, function(N) {
sapply(1:N, function(P) get_p_val(N = N, P = P, Rsq = Rsq)
})
sapply(1:N_max, function(N) {
sapply(1:N, function(P) get_p_val(N = N, P = P, Rsq = Rsq))
})
sapply(1:N_max, function(N) {
sapply(1:(N-2), function(P) get_p_val(N = N, P = P, Rsq = Rsq))
})
p = 0.02
sapply(1:N_max, function(N) {
which.min(abs(sapply(1:(N-2), function(P) get_p_val(N = N, P = P, Rsq = Rsq)), p))
})
sapply(1:N_max, function(N) {
which.min(abs(sapply(1:(N-2), function(P) get_p_val(N = N, P = P, Rsq = Rsq)) - p))
})
sapply(3:N_max, function(N) {
which.min(abs(sapply(1:(N-2), function(P) get_p_val(N = N, P = P, Rsq = Rsq)) - p))
})
sapply(3:N_max, function(N) {
p_vals = abs(sapply(1:(N-2), function(P) get_p_val(N = N, P = P, Rsq = Rsq))
P = which.min(abs(pvals - p))
c(P, p_vals[P])
})
sapply(3:N_max, function(N) {
p_vals = sapply(1:(N-2), function(P) get_p_val(N = N, P = P, Rsq = Rsq))
P = which.min(abs(pvals - p))
c(P, p_vals[P])
})
sapply(3:N_max, function(N) {
p_vals = sapply(1:(N-2), function(P) get_p_val(N = N, P = P, Rsq = Rsq))
P = which.min(abs(p_vals - p))
c(P, p_vals[P])
})
get_p = function(N_max, Rsq, p) {
sapply(3:N_max, function(N) {
p_vals = sapply(1:(N-2), function(P) get_p_val(N = N, P = P, Rsq = Rsq))
P = which.min(abs(p_vals - p))
c(P, p_vals[P])
})
}
get_p(170, 0.135, 0.02) -> res
plot(3:N_max, res[1, ])
plot(3:N_max, res[1, ])
plot(3:N_max, res[2, ])
plot(50:N_max, res[2, ])
plot(50:N_max, res[2, 50:N_max])
res
plot(50:N_max, res[2, (50:N_max) - 2])
0.7*160
0.7*170
0.3*170
plot(3:N_max, res[1, ])
abline(h = 4)
plot(20:N_max, get_p_val(N_max, P = 4, Rsq = 0.135))
plot(20:N_max, get_p_val(20:N_max, P = 4, Rsq = 0.135))
plot(70:N_max, get_p_val(70:N_max, P = 4, Rsq = 0.135))
plot(70:N_max, get_p_val(70:N_max, P = 4, Rsq = 0.135))
abline(h = 0.02)
plot(70:N_max, get_p_val(70:N_max, P = 4, Rsq = 0.135))
abline(h = 0.02)
abline(v = 85)
get_p_val = function(N, P, Rsq) {
f = (N - (P + 1))/P*Rsq/(1 - Rsq)
pf(f, df1 = P, df2 = N - (P + 1), lower.tail = FALSE)
}
get_p_val(N = 170, P = 4, Rsq = 0.135)
plot(70:N_max, get_p_val(70:N_max, P = 4, Rsq = 0.135))
abline(h = 0.02)
abline(v = 85)
plot(70:170, get_p_val(70:170, P = 4, Rsq = 0.135))
abline(h = 0.02)
abline(v = 85)
x1 = rnorm(160)
x2 = rnorm(160)
x3 = rnorm(160)
y = rnorm(160)
summary(lm(y ~ x1 + x2 + x3))$fstatistic
summary(lm(y ~ x1 + x2 + x3))
get_p_val(160, 3, 0.03566)
